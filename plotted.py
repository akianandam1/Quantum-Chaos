import numpy as np
import matplotlib.pyplot as plt

def main():
    # ---------------------------------------------------------
    # 1. Load or define your x and y arrays
    # Replace these with your real data
    # ---------------------------------------------------------
    #x_data = np.array([1.66,2.941,4.249,4.431,5.629,5.909,6.332,7.075,7.184,7.887,8.173,8.315,8.601,8.688,8.924,9.091,9.213,9.891,9.969,10.068,10.165,10.241,10.642,10.737,11.015,11.422,11.487,11.699,11.796,11.906])

    # Doing the 5000 sorted eigenpair trial
#     x_data=np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212992, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102464, 9.091081620812826, 9.212850090574376, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.01471955148593, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643095, 12.737265272155053, 12.797248706045165, 12.873604017567116, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335884, 13.980002150638974, 14.081823143310501, 14.236346454620127]
# )
#
#     y_data = np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.9211809641054381, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907299, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035214, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994329, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459213, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021149, 0.9656241009450395, 0.9341930067703232, 0.917216241658134]
# )


    # Doing it with regular eigenpairs but sorting the first 5000 in file
#     x_data = np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212991, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102466, 9.091081620812826, 9.212850090574374, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.014719551485925, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643097, 12.737265272155053, 12.797248706045165, 12.873604017567112, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335889, 13.980002150638974, 14.081823143310501, 14.236346454620127]
# )
#     y_data=np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.921180964105438, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907302, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035217, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994328, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459215, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021147, 0.9656241009450395, 0.9341930067703232, 0.917216241658134]
# )

    # Doing it with regular eigenpairs, sorting in file, 40,000 eigenstates starting from #100
    x_data=np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212991, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102466, 9.091081620812826, 9.212850090574374, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.014719551485925, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643097, 12.737265272155053, 12.797248706045165, 12.873604017567112, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335889, 13.980002150638974, 14.081823143310501, 14.236346454620127, 14.28745561581887, 14.34710647387157, 14.40235194281361, 14.455229875077976, 14.506031826024016, 14.558226625633575, 14.706963739426433, 14.80249778659417, 14.864805052824286, 15.04421214182521, 15.093297106899545, 15.159534458189185, 15.223236150695023, 15.27341921936005, 15.536685044357217, 15.594012984467378, 15.639597471527328, 15.804362928133834, 15.850085345088491, 15.899277099813984, 16.073061115928645, 16.1173462469953, 16.22354286412354, 16.338380137117614, 16.383649564606557, 16.432421616452313, 16.478701237315665, 16.522143164152517, 16.566825915440642, 16.6097326229648, 16.661472849216754, 16.71277051154289, 16.756872441281683, 16.80213007253436, 16.844420545006614, 16.936741127460863, 17.056731172397303, 17.10008717805458, 17.17039936655064, 17.216972345097954, 17.287357559925727, 17.410277966511458, 17.45038104659399, 17.493329587101947, 17.535145482579434, 17.576024504188073, 17.61749279947597, 17.657874087928505, 17.69838347276529, 17.73947787307609, 17.78088884282831, 17.894498134018956, 17.97862849282803, 18.020237168021517, 18.086523536999618, 18.12612975925233, 18.16704290205646, 18.208776332927588, 18.24871641312057, 18.293262114108302, 18.331591468492867, 18.370181196658468, 18.41113268731357, 18.450458637442463, 18.50198177723655, 18.54369018633191, 18.58281607622134, 18.623320532279354, 18.66082500690793, 18.777953237225507, 18.85460343758813, 18.89628927188969, 18.96010714475991, 18.996891951294455, 19.088774503282977, 19.172116511651442, 19.20963854038865, 19.249570020152113, 19.285569429046507, 19.322298173458353, 19.36010227300528, 19.396421539266292, 19.437258273559006, 19.473500321100545, 19.509185880887724, 19.641761744808537, 19.68926224003258, 19.73316332061953, 19.788408442232793, 19.824142380982114, 19.86436679001537, 19.90094982631547, 19.93635529900655, 19.97437077825145, 20.009230551922396, 20.048787911073273, 20.08666288066543, 20.121063314543132, 20.170374921015746, 20.20494202840597, 20.23991797645145, 20.275666167834586, 20.310613890001857, 20.344029335734646, 20.377003674712153, 20.42193091605969, 20.47418151973041, 20.50896735864501, 20.56527225736542, 20.602721438612065, 20.662827834160375, 20.766718424203663, 20.799478239948076, 20.835025487618005, 20.86958311950572, 20.90367486002197, 20.941123648629382, 20.973673202761596, 21.009616475147354, 21.034088715739134, 21.049475414702965, 21.06565279565978, 21.082113749906284, 21.150439560288206, 21.22202193231765, 21.238142527568684, 21.253808219662464, 21.269696037666414, 21.29816934668669, 21.347268541217808, 21.379420396662287, 21.417300966443623, 21.450192672160274, 21.482521730024402, 21.518254896529733, 21.550427048792418, 21.5870816374763, 21.61358410658022, 21.629519255176657, 21.645508717973517, 21.66152569588043, 21.688481964156352, 21.719969979708356, 21.751342889843745, 21.781804210101512, 21.81263090789697, 21.84387110358547, 21.874811230765385, 21.90507970353683, 21.963123927746768, 21.998286229145773, 22.037594069517173, 22.086594067513648, 22.11627204710149, 22.214995354678322, 22.26849600873751, 22.30048392245396, 22.335659571028845, 22.365228505350544, 22.398875141236047, 22.431020732099558, 22.461672467074244, 22.49488215823321, 22.51115294613349, 22.526309527350563, 22.54087755056894, 22.556725609528502, 22.667606045084653, 22.687019735449468, 22.701321355133192, 22.716133959481855, 22.730654724991453, 22.74957798018106, 22.77424220349084, 22.789231623151558, 22.80386868651839, 22.82435262389038, 22.858872953277388, 22.890527621613423, 22.920966071378903, 22.956160795335773, 22.984519271402416, 23.018925830975444, 23.045776653861324, 23.06037053569753, 23.07446815461201, 23.088969754457935, 23.113617870382104, 23.14408908615594, 23.172811277477148, 23.201862329170027, 23.23029582861632, 23.259049706235434, 23.288060515484208, 23.31683533389669, 23.371001758948616, 23.405192053268838, 23.438842154110965, 23.48717024543782, 23.514821065828777, 23.60235087224839, 23.658827271265615, 23.687396589546733, 23.721571841794, 23.749265561108345, 23.781508529487443, 23.812647174486063, 23.83986633622576, 23.87231814622031, 23.88792005531411, 23.90194688838681, 23.915571998299466, 23.930277199998333, 24.02888600574343, 24.054041713602942, 24.066856714954707, 24.080568698486942, 24.09396853295563, 24.110999914692925, 24.135467182797782, 24.15054772926849, 24.164431548055774, 24.182698063397325, 24.215705379503884, 24.246116206244594, 24.272860111801087, 24.30683617119359, 24.332956861043208, 24.3651245140596, 24.39282703244577, 24.406358143170234, 24.419587456265504, 24.432800051169615, 24.45581009045478, 24.48481707935839, 24.510823772647367, 24.539499660223267, 24.56634210364962, 24.59344873223308, 24.62170706642374, 24.647555225009068, 24.695220282401696, 24.729957535634277, 24.760316217364867, 24.808867140182393, 24.83512551368261, 24.895597112248534, 24.943333388066787, 24.957276527150302, 24.970110427137847, 24.98409030713135, 25.012054365135782, 25.04244954629571, 25.068348730981306, 25.101666044873156, 25.127266675843117, 25.15571700260141, 25.18273823440428, 25.19575998259146, 25.208638526184803, 25.2212239062911, 25.257109730797566, 25.339882264795605, 25.352277821674257, 25.364950009822998, 25.37767289982779, 25.390384876110218, 25.4110072709831, 25.43166061173944, 25.444269152391048, 25.457529531707024, 25.479235120020352, 25.513336086639487, 25.537870615022698, 25.566310164815317, 25.596255094513662, 25.620534755437376, 25.65624110104321, 25.675145852475975, 25.687417804747714, 25.699544143866074, 25.712874952890626, 25.739456260242253, 25.765033294311646, 25.7903675951392, 25.818705269648422, 25.84337708306992, 25.870231389525124, 25.896025124763927, 25.921463092874824, 25.975074198704206, 25.99912530186303, 26.036911326662306, 26.074607359385876, 26.098578160052863, 26.1769657877782, 26.19827757633199, 26.20996869539807, 26.221601264714895, 26.237892256201576, 26.270192885527813, 26.296101268219868, 26.32191694856817, 26.3521679585503, 26.375562300630076, 26.406461108992286, 26.425626246494847, 26.437630624398107, 26.449188126278177, 26.46114923161942, 26.527849779468788, 26.575520524952175, 26.586936551581797, 26.598319953378226, 26.60999596056133, 26.62437562372137, 26.64711335533132, 26.662852525037565, 26.67446860925249, 26.688400762771856, 26.714346883801774, 26.74395561501801, 26.76653843789732, 26.797816262366997, 26.822860624909826, 26.848679294075293, 26.881340249899264, 26.89424324854552, 26.905745821298652, 26.917190647529132, 26.926538736596573, 26.93772869571998, 26.956854387598828, 27.0797770541876, 27.184554303471806, 27.206411139475968, 27.407840504203207, 27.431194348560666, 27.530587554840576, 27.655387467050733, 27.676827255599864, 27.853603286762674, 27.898684927211256, 27.975325135750776, 28.11894448881445, 28.139793759146237, 28.29295323086714, 28.357704607971737, 28.411462477662827, 28.573702933925407, 28.593809810251447]
)
    y_data = np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.921180964105438, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907302, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035217, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994328, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459215, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021147, 0.9656241009450395, 0.9341930067703232, 0.917216241658134, 0.9743020951760958, 0.964877036467613, 0.9421029752853142, 0.9451796471114501, 0.9191261189606946, 0.9305817329359798, 0.9518558500449019, 0.9563888829128214, 0.9630337441777577, 0.976803473381766, 0.9634856103855608, 0.9578611888455675, 0.9286248931745544, 0.9403506619921081, 0.9503052581848322, 0.9462522162486073, 0.9346617985389298, 0.9593656562633985, 0.9694213746806714, 0.947654125420516, 0.9473120714365361, 0.9555536722143585, 0.9494874979460478, 0.9306930014402812, 0.9483442148945233, 0.9542682143172623, 0.9771018153827646, 0.9787629903219844, 0.94622071107976, 0.9723295426687278, 0.9515062022937982, 0.954157215292964, 0.9560347234997951, 0.9432693511021634, 0.9821905857973996, 0.954970063226551, 0.9452493778719355, 0.9571386489463746, 0.9633136485160305, 0.9717263886094354, 0.9540720618963638, 0.9470779840490813, 0.9622193919335852, 0.9586843264810614, 0.9699041784084834, 0.9855282965012389, 0.9575705105723794, 0.953709944920415, 0.9373982837060869, 0.9687932096675798, 0.9534480249283789, 0.9683224753975577, 0.978328518522063, 0.9623327400968126, 0.9545952184708861, 0.9303845328561272, 0.9660207043927719, 0.953390512644737, 0.9774233755251284, 0.9742847052290355, 0.977767224607695, 0.9660556569707662, 0.9678354255747246, 0.9631001537511762, 0.941000535579641, 0.9645470883592696, 0.947267445615344, 0.9745227427594597, 0.9639613535369361, 0.9616660989200324, 0.9496637033109111, 0.9580081463296749, 0.9908512460941579, 0.9498670767643457, 0.9698280888208469, 0.9483138506557771, 0.9697097882611478, 0.954383226618716, 0.9809066222296983, 0.9738664912031153, 0.9869974645367131, 0.974393984697372, 0.9650368717402121, 0.9441006369230219, 0.9490538882192893, 0.9722823897577605, 0.9543747564394154, 0.9617314311829186, 0.9557987665546542, 0.9510547447873505, 0.9575249537234403, 0.9517808621044327, 0.9350043206809678, 0.9667076951391832, 0.9798703549947438, 0.9668836783791829, 0.9739426378151004, 0.9667011355599864, 0.9578444713427732, 0.9700285021876021, 0.9767689937461118, 0.9645051196129425, 0.9796747890102967, 0.9729331403374927, 0.9718139588240059, 0.9714954531618705, 0.9665680893447408, 0.9715799804960468, 0.9434380694391281, 0.9600151224870214, 0.9680014501099987, 0.9626853501757008, 0.9589283821670713, 0.9475823775782832, 0.9645697134221269, 0.9615200311095805, 0.963437109181988, 0.9693295457597415, 0.9876209529008677, 0.9768890960158677, 0.9824790666843974, 0.9588528494401788, 0.9721063776781178, 0.9805193923038443, 0.962685267845407, 0.9431660312691424, 0.964868285924154, 0.956603925168463, 0.9675647984235609, 0.9717281895070099, 0.9826189439468521, 0.9726204354794205, 0.9604615887207204, 0.964630481693994, 0.9626400733003964, 0.9714004012804623, 0.9627909110720881, 0.9599493236708576, 0.9700721867479247, 0.9653063871055144, 0.9413698886258536, 0.9751684506322351, 0.9670020774599709, 0.9673744951312981, 0.9665846484246317, 0.9832840335616834, 0.9742359005404676, 0.9634186286259364, 0.9644124527877854, 0.9769349818646001, 0.9715108873770029, 0.9716748913041294, 0.9582955490072738, 0.9719374118836722, 0.9698464230502618, 0.9784737123875396, 0.9484383876030651, 0.9677554023096862, 0.963145784486494, 0.9853121053192578, 0.9678342046834766, 0.9773854367913998, 0.9626080980459776, 0.9540787002192684, 0.9662825894805267, 0.9661819432904153, 0.9653297976328042, 0.9902736552767051, 1.0132484443601424, 0.9791959067600647, 0.9459619429068575, 0.9759515495638341, 0.9871119366205464, 0.9694209017951081, 0.9602408449051252, 0.9628381835732438, 0.9733452358629568, 0.9752700754000907, 0.9830280874942972, 0.9661590690870184, 0.9654019762091868, 0.9659784925760989, 0.9803012740594019, 0.9664335178383717, 1.0007488427550368, 0.95974670132827, 1.0014091260579412, 0.9696182598586509, 0.956300993224844, 0.9576475631659507, 0.9506629277120915, 0.9671998197844939, 0.9641182138557043, 0.9665441556405766, 0.982430117805305, 0.9869786464450984, 0.9641133877009538, 0.9647915102843662, 0.9844304861118656, 0.9842497507058282, 0.9704738296507288, 0.9771968665378865, 0.9792276868004681, 0.9743365913000973, 0.9834353942110573, 0.9625254840685575, 0.9679327625062782, 0.9530948653125381, 0.9735411182606956, 0.9528626918212109, 0.9714230114402231, 0.9740895271327515, 0.9710965439492728, 0.979014431968354, 0.9587831273207938, 0.9868043198054098, 0.9585042703627377, 0.9643444324183524, 0.9573401575098818, 0.9862272266415651, 0.9716480390305907, 0.9686268655529389, 0.9768200075669342, 0.9643708657679296, 0.9676860171500655, 0.9699788812251166, 0.9800792109563748, 0.9841779689485022, 0.991192360118255, 0.9820933858447859, 0.9844627131727196, 0.9762702936541953, 0.971968201547442, 0.9623119243199524, 0.9641536146887395, 0.9719260918284109, 0.9662763280332665, 0.9800435678616491, 0.9726496742718682, 0.976623000408359, 0.9787644793555998, 0.9718411459732651, 0.9668569927243676, 0.9726787167897827, 0.9663009178282306, 0.9754776277307435, 0.9596341960443746, 0.9762527229438948, 0.9790906952551596, 0.9872862524545186, 0.9776495360483488, 0.9857333448777537, 0.9589683812214008, 0.9673903591106522, 0.9828989888266928, 0.962081512429101, 0.9828243490273519, 0.9781345319752565, 0.9621789262263745, 0.9762153847579249, 0.9827136529368208, 0.9808834424605445, 0.9393949370029149, 0.979694901527815, 0.9886655955540877, 0.961219367996941, 0.968137572111774, 0.9829217814736668, 0.9694801998289748, 0.9687192180951297, 0.9862658228761686, 0.9659258342776829, 0.964796048137749, 0.970432265690066, 0.9873761698995002, 0.9822639519444898, 0.9858514767092401, 0.9701359349417311, 0.9639947268319383, 0.9755352842636986, 0.975335680055424, 0.9649139079717978, 0.957862167274383, 0.9730369915626469, 0.9678773655738705, 0.9719544951488924, 0.9825266961549, 0.9905820512601008, 0.9909862325599742, 0.9855786145746616, 0.97643575609608, 0.9761119696318546, 0.9756095747468639, 0.973956356611179, 0.9777411448490108, 0.9735687361730591, 0.9865937757277737, 0.9813806880525864, 0.9844465726067937, 0.9882587979777913, 0.9660332899242546, 0.9699236516193737, 0.9766018089735065, 0.960402574730398, 0.973817440724194, 0.9620612211019234, 0.9747920810637372, 0.9781320088453691, 0.9717983741648113, 0.971097198722804, 0.9645645569028584, 0.9550082479066837, 0.9684146166835275, 0.981847240155485, 0.9666477242913524, 0.9858630949741679, 0.9879836411323758, 0.9874507003087264, 0.9686280268098799, 0.9741883792872872, 0.9718742094413036, 0.9784153590173578, 0.982585238102184, 0.9938586750600109, 0.9840115431542104, 0.9791002291290094, 0.972583530200794, 0.9707130784069878, 0.9996738408027224, 0.9594311074282345, 0.9669020712076691, 0.982254017028771, 0.9700053114737649, 0.9596606434466214, 0.9599879265621205, 0.9786127295040831, 0.9924711313701045, 0.9834054145965934, 0.9724442055832927, 0.985357573635743, 0.981585303152193, 0.9675169199230298, 0.9703692601495191, 0.9834740162366592, 0.9929637228294496, 0.9798701526819191, 0.9675737369759527, 0.9836251054225484, 0.9746142190877118, 0.9782645462269302, 0.9716296463583005]
)

    y_data*=0.966
    print(y_data[0])

    # ---------------------------------------------------------
    # 2. Define the comparison curve f(x) = x / (1 + x)
    # ---------------------------------------------------------
    x_curve = np.linspace(0, 30, 400)
    y_curve = x_curve / (1 + x_curve)

    # ---------------------------------------------------------
    # 3. Plot
    # ---------------------------------------------------------
    plt.figure(figsize=(8, 6))
    plt.xlim(0, 30)
    plt.plot(x_data, y_data, 'o', label='Computed Values', markersize=8)
    plt.plot(x_curve, y_curve, '-', label='x / (1 + x)', linewidth=2)
    #plt.set_xscale('log')
    plt.xlabel('# of open modes deduced from energy value')
    plt.ylabel('<w_12>')
    #plt.xscale("log")
    plt.title('Computed Values vs. x/(1+x) Curve')
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()

if __name__ == "__main__":
    main()
