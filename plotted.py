import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl

def main():
    # ----------------------- publication-style defaults -----------------------
    mpl.rcParams.update(
        {
            "font.size": 12,
            "axes.titlesize": 13,
            "axes.labelsize": 12,
            "axes.linewidth": 1.1,
            "xtick.labelsize": 11,
            "ytick.labelsize": 11,
            "legend.fontsize": 11,
            "figure.dpi": 160,
            "savefig.dpi": 300,
            "savefig.bbox": "tight",
            "savefig.transparent": False,
        }
    )

    # ----------------------------- output controls ----------------------------
    SAVE_PNG = False
    SAVE_PDF = False
    OUT_PNG = "computed_vs_theory.png"
    OUT_PDF = "computed_vs_theory.pdf"

    # If True, show an interactive window; if False, just save (if enabled)
    SHOW = True

    # ---------------------------------------------------------
    # 1. Load or define your x and y arrays
    # Replace these with your real data
    # ---------------------------------------------------------
    #x_data = np.array([1.66,2.941,4.249,4.431,5.629,5.909,6.332,7.075,7.184,7.887,8.173,8.315,8.601,8.688,8.924,9.091,9.213,9.891,9.969,10.068,10.165,10.241,10.642,10.737,11.015,11.422,11.487,11.699,11.796,11.906])

    # Doing the 5000 sorted eigenpair trial
#     x_data=np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212992, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102464, 9.091081620812826, 9.212850090574376, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.01471955148593, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643095, 12.737265272155053, 12.797248706045165, 12.873604017567116, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335884, 13.980002150638974, 14.081823143310501, 14.236346454620127]
# )
#
#     y_data = np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.9211809641054381, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907299, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035214, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994329, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459213, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021149, 0.9656241009450395, 0.9341930067703232, 0.917216241658134]
# )


    # Doing it with regular eigenpairs but sorting the first 5000 in file
#     x_data = np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212991, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102466, 9.091081620812826, 9.212850090574374, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.014719551485925, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643097, 12.737265272155053, 12.797248706045165, 12.873604017567112, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335889, 13.980002150638974, 14.081823143310501, 14.236346454620127]
# )
#     y_data=np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.921180964105438, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907302, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035217, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994328, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459215, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021147, 0.9656241009450395, 0.9341930067703232, 0.917216241658134]
# )

    # Doing it with regular eigenpairs, sorting in file, 40,000 eigenstates starting from #100
    #x_data=np.array([1.660295831609667, 2.941215649444686, 4.248656152302616, 4.431415397123253, 5.628748330212991, 5.9088760129731694, 6.332363531570938, 7.075485947751073, 7.184401468517835, 7.8866413770873685, 8.173400383451424, 8.31464710446597, 8.60136454443708, 8.68785843749137, 8.924101796102466, 9.091081620812826, 9.212850090574374, 9.89088633515882, 9.969204304757163, 10.0683909161584, 10.165280732698559, 10.241036633446276, 10.641649809359153, 10.736583337472778, 11.014719551485925, 11.421693369357966, 11.48739509696637, 11.69898895004675, 11.796183821044137, 11.905983001257265, 12.096707124109466, 12.158487428151503, 12.336572817760333, 12.448188535610852, 12.530843255643097, 12.737265272155053, 12.797248706045165, 12.873604017567112, 12.946594827407987, 13.00918508527292, 13.342360861037266, 13.399358012790817, 13.52634401343886, 13.666893302805182, 13.723267982750547, 13.910036230335889, 13.980002150638974, 14.081823143310501, 14.236346454620127, 14.28745561581887, 14.34710647387157, 14.40235194281361, 14.455229875077976, 14.506031826024016, 14.558226625633575, 14.706963739426433, 14.80249778659417, 14.864805052824286, 15.04421214182521, 15.093297106899545, 15.159534458189185, 15.223236150695023, 15.27341921936005, 15.536685044357217, 15.594012984467378, 15.639597471527328, 15.804362928133834, 15.850085345088491, 15.899277099813984, 16.073061115928645, 16.1173462469953, 16.22354286412354, 16.338380137117614, 16.383649564606557, 16.432421616452313, 16.478701237315665, 16.522143164152517, 16.566825915440642, 16.6097326229648, 16.661472849216754, 16.71277051154289, 16.756872441281683, 16.80213007253436, 16.844420545006614, 16.936741127460863, 17.056731172397303, 17.10008717805458, 17.17039936655064, 17.216972345097954, 17.287357559925727, 17.410277966511458, 17.45038104659399, 17.493329587101947, 17.535145482579434, 17.576024504188073, 17.61749279947597, 17.657874087928505, 17.69838347276529, 17.73947787307609, 17.78088884282831, 17.894498134018956, 17.97862849282803, 18.020237168021517, 18.086523536999618, 18.12612975925233, 18.16704290205646, 18.208776332927588, 18.24871641312057, 18.293262114108302, 18.331591468492867, 18.370181196658468, 18.41113268731357, 18.450458637442463, 18.50198177723655, 18.54369018633191, 18.58281607622134, 18.623320532279354, 18.66082500690793, 18.777953237225507, 18.85460343758813, 18.89628927188969, 18.96010714475991, 18.996891951294455, 19.088774503282977, 19.172116511651442, 19.20963854038865, 19.249570020152113, 19.285569429046507, 19.322298173458353, 19.36010227300528, 19.396421539266292, 19.437258273559006, 19.473500321100545, 19.509185880887724, 19.641761744808537, 19.68926224003258, 19.73316332061953, 19.788408442232793, 19.824142380982114, 19.86436679001537, 19.90094982631547, 19.93635529900655, 19.97437077825145, 20.009230551922396, 20.048787911073273, 20.08666288066543, 20.121063314543132, 20.170374921015746, 20.20494202840597, 20.23991797645145, 20.275666167834586, 20.310613890001857, 20.344029335734646, 20.377003674712153, 20.42193091605969, 20.47418151973041, 20.50896735864501, 20.56527225736542, 20.602721438612065, 20.662827834160375, 20.766718424203663, 20.799478239948076, 20.835025487618005, 20.86958311950572, 20.90367486002197, 20.941123648629382, 20.973673202761596, 21.009616475147354, 21.034088715739134, 21.049475414702965, 21.06565279565978, 21.082113749906284, 21.150439560288206, 21.22202193231765, 21.238142527568684, 21.253808219662464, 21.269696037666414, 21.29816934668669, 21.347268541217808, 21.379420396662287, 21.417300966443623, 21.450192672160274, 21.482521730024402, 21.518254896529733, 21.550427048792418, 21.5870816374763, 21.61358410658022, 21.629519255176657, 21.645508717973517, 21.66152569588043, 21.688481964156352, 21.719969979708356, 21.751342889843745, 21.781804210101512, 21.81263090789697, 21.84387110358547, 21.874811230765385, 21.90507970353683, 21.963123927746768, 21.998286229145773, 22.037594069517173, 22.086594067513648, 22.11627204710149, 22.214995354678322, 22.26849600873751, 22.30048392245396, 22.335659571028845, 22.365228505350544, 22.398875141236047, 22.431020732099558, 22.461672467074244, 22.49488215823321, 22.51115294613349, 22.526309527350563, 22.54087755056894, 22.556725609528502, 22.667606045084653, 22.687019735449468, 22.701321355133192, 22.716133959481855, 22.730654724991453, 22.74957798018106, 22.77424220349084, 22.789231623151558, 22.80386868651839, 22.82435262389038, 22.858872953277388, 22.890527621613423, 22.920966071378903, 22.956160795335773, 22.984519271402416, 23.018925830975444, 23.045776653861324, 23.06037053569753, 23.07446815461201, 23.088969754457935, 23.113617870382104, 23.14408908615594, 23.172811277477148, 23.201862329170027, 23.23029582861632, 23.259049706235434, 23.288060515484208, 23.31683533389669, 23.371001758948616, 23.405192053268838, 23.438842154110965, 23.48717024543782, 23.514821065828777, 23.60235087224839, 23.658827271265615, 23.687396589546733, 23.721571841794, 23.749265561108345, 23.781508529487443, 23.812647174486063, 23.83986633622576, 23.87231814622031, 23.88792005531411, 23.90194688838681, 23.915571998299466, 23.930277199998333, 24.02888600574343, 24.054041713602942, 24.066856714954707, 24.080568698486942, 24.09396853295563, 24.110999914692925, 24.135467182797782, 24.15054772926849, 24.164431548055774, 24.182698063397325, 24.215705379503884, 24.246116206244594, 24.272860111801087, 24.30683617119359, 24.332956861043208, 24.3651245140596, 24.39282703244577, 24.406358143170234, 24.419587456265504, 24.432800051169615, 24.45581009045478, 24.48481707935839, 24.510823772647367, 24.539499660223267, 24.56634210364962, 24.59344873223308, 24.62170706642374, 24.647555225009068, 24.695220282401696, 24.729957535634277, 24.760316217364867, 24.808867140182393, 24.83512551368261, 24.895597112248534, 24.943333388066787, 24.957276527150302, 24.970110427137847, 24.98409030713135, 25.012054365135782, 25.04244954629571, 25.068348730981306, 25.101666044873156, 25.127266675843117, 25.15571700260141, 25.18273823440428, 25.19575998259146, 25.208638526184803, 25.2212239062911, 25.257109730797566, 25.339882264795605, 25.352277821674257, 25.364950009822998, 25.37767289982779, 25.390384876110218, 25.4110072709831, 25.43166061173944, 25.444269152391048, 25.457529531707024, 25.479235120020352, 25.513336086639487, 25.537870615022698, 25.566310164815317, 25.596255094513662, 25.620534755437376, 25.65624110104321, 25.675145852475975, 25.687417804747714, 25.699544143866074, 25.712874952890626, 25.739456260242253, 25.765033294311646, 25.7903675951392, 25.818705269648422, 25.84337708306992, 25.870231389525124, 25.896025124763927, 25.921463092874824, 25.975074198704206, 25.99912530186303, 26.036911326662306, 26.074607359385876, 26.098578160052863, 26.1769657877782, 26.19827757633199, 26.20996869539807, 26.221601264714895, 26.237892256201576, 26.270192885527813, 26.296101268219868, 26.32191694856817, 26.3521679585503, 26.375562300630076, 26.406461108992286, 26.425626246494847, 26.437630624398107, 26.449188126278177, 26.46114923161942, 26.527849779468788, 26.575520524952175, 26.586936551581797, 26.598319953378226, 26.60999596056133, 26.62437562372137, 26.64711335533132, 26.662852525037565, 26.67446860925249, 26.688400762771856, 26.714346883801774, 26.74395561501801, 26.76653843789732, 26.797816262366997, 26.822860624909826, 26.848679294075293, 26.881340249899264, 26.89424324854552, 26.905745821298652, 26.917190647529132, 26.926538736596573, 26.93772869571998, 26.956854387598828, 27.0797770541876, 27.184554303471806, 27.206411139475968, 27.407840504203207, 27.431194348560666, 27.530587554840576, 27.655387467050733, 27.676827255599864, 27.853603286762674, 27.898684927211256, 27.975325135750776, 28.11894448881445, 28.139793759146237, 28.29295323086714, 28.357704607971737, 28.411462477662827, 28.573702933925407, 28.593809810251447]
# #)
#     x_data=np.array([2.004798960183452, 4.959387450630871, 8.253045107176614, 8.39786308597107, 9.893988909091986, 10.19694431704745, 10.670707158280889, 11.535342023851161, 11.636033216831763, 12.625987708079137, 12.994675931923455, 13.26168373135037, 14.070450115472585, 14.14773096159708, 14.285188166039646, 14.391129645000383, 14.524656622755767, 15.246605976339554, 15.31867434481553, 15.796103383123418, 16.238552248319436, 16.30685874473088, 16.451725496877515, 16.518757233763743, 16.83256010165726, 17.266613044646455, 17.329032570535947, 17.553492636357245, 17.64576161042231, 17.806011483112265, 18.118733841293185, 18.177950521300883, 18.288839031084418, 18.36712845607635, 18.51534433499708, 19.04344090338752, 19.097951990269806, 19.260694522771548, 19.386511679459257, 19.454465501379328, 19.818638257588827, 19.870858834542574, 19.957877711695055, 20.04675332652404, 20.09656792005594, 20.313514720808943, 20.37811439930293, 20.503549364912484, 20.687931257373716, 20.73841718776497, 20.92446317706085, 21.00634792441842, 21.12627445098691, 21.402890822526967, 21.45088989940076, 21.545384735402276, 21.61314934922301, 21.678689986381105, 21.8746333791061, 21.92135189866518, 22.078747395948056, 22.212638439836187, 22.25764146620627, 22.459909929237092, 22.50519779844975, 22.62350085856948, 22.761936461920637, 22.80518855127455, 22.853485110222415, 22.89666602977351, 22.960201140019745, 23.047087233703373, 23.08932267040447, 23.255786797896345, 23.336923967960992, 23.416467617939507, 23.61124509067693, 23.65154307217363, 23.79094107970431, 23.8852045296725, 23.938661559091425, 24.12938058333629, 24.169486736656786, 24.211365372761396, 24.254513662862234, 24.293579010258732, 24.393600929799153, 24.435860631069744, 24.5379236049241, 24.670153182456076, 24.708988361963453, 24.887532320010294, 24.952619360902073, 24.99100973887603, 25.155215721755134, 25.211533376197462, 25.298313644194806, 25.443909437436005, 25.48097449666917, 25.524257531451624, 25.56214539361718, 25.61080348198345, 25.698025462280608, 25.734373353863887, 25.865545263422256, 25.957012601752712, 26.003656872748365, 26.19034658867733, 26.225799873121993, 26.272906562910066, 26.43591628954487, 26.470790591525482, 26.58627758975501, 26.692473705558587, 26.726450295932505, 26.769981306281956, 26.804292609039702, 26.86336625759779, 26.933559264104897, 26.966791311673756, 27.106152368306695, 27.176842993769604, 27.237436677001106, 27.40009542096129, 27.432885792057796, 27.490970652271034, 27.634349473534375, 27.667088323790523, 27.791963734316855, 27.878746270789335, 27.911406767718912, 27.95431076101479, 27.98595629966366, 28.016805028217153, 28.048358197893545, 28.07986949626223, 28.111894587387074, 28.143432802808512, 28.30428920395796, 28.34458663968998, 28.431749527901914, 28.55921967082794, 28.59010331611442, 28.669885261742287, 28.784167567055423, 28.81455786465268, 28.891611258401355, 29.004966352801794, 29.034842453321453, 29.06470444673099, 29.09436872553827, 29.123802049001405, 29.15481165119759, 29.183173386199034, 29.214604127585677, 29.24501910751224, 29.30280843699246, 29.438700072071075, 29.46676648178278, 29.594215255043054, 29.675401759491496, 29.70333615878115, 29.77650551578589, 29.829254304672446, 29.857426826638577, 29.888428216954274, 29.916621990247005, 30.011408228037435, 30.10097220051663, 30.12755311139956, 30.15523350907561, 30.18296571588037, 30.21201186568637, 30.240672939308443, 30.26761991954252, 30.301475612512007, 30.32978689573606, 30.397431913263528, 30.5150464581156, 30.541254344427546, 30.567711932739677, 30.662546083288536, 30.738229339688196, 30.76434110987542, 30.82669337348029, 30.886207041819674, 30.912473952420456, 30.94433491391549, 30.970077679576498, 31.046684294453318, 31.148489378596604, 31.174045527676544, 31.201337677850443, 31.227570478457277, 31.25420686923306, 31.282608258331656, 31.30791733096738, 31.339654151712324, 31.368141857937463, 31.40846078882325, 31.512637916831647, 31.537254024220605, 31.562025473096806, 31.58734605468123, 31.61692280214937, 31.75423421771329, 31.7786779024605, 31.803030681719957, 31.896567959629106, 31.922225725675172, 31.9494385033258, 31.97767083647656, 32.001836828698686, 32.133782293086085, 32.17484733406889, 32.198534458415885, 32.22230974188154, 32.24662508019329, 32.27389255565911, 32.30043879951752, 32.32337372089671, 32.35960996708173, 32.38331878725767, 32.44662052463043, 32.522204295423656, 32.54486091217911, 32.57122479901434, 32.594602091205864, 32.65394795686453, 32.75711848319341, 32.7794201427994, 32.81757447597258, 32.89493575099634, 32.917750302767196, 32.94722446774499, 32.97307086201016, 33.00507118964869, 33.11752289782647, 33.139720799983195, 33.16412521753527, 33.18809935827064, 33.20994647885023, 33.265554526475995, 33.28832142407598, 33.31634583127681, 33.34668315485314, 33.36822154402745, 33.46864174560466, 33.5031011078507, 33.52615820033003, 33.55230028103427, 33.57353677805191, 33.68004237490703, 33.73139012620099, 33.75243384714821, 33.773270066313984, 33.794474482607946, 33.84099654928977, 33.86900583438246, 33.89224664397148, 33.92198626991003, 33.94305490888445, 34.030142623474006, 34.08519916770522, 34.105914818698125, 34.13028981736531, 34.151178758064226, 34.191417275340626, 34.228026115472574, 34.248273642681745, 34.28525783322533, 34.305904168779605, 34.36426665193199, 34.43696701843249, 34.45688703763302, 34.48460387198879, 34.50619053623472, 34.559062541147995, 34.65590129976896, 34.675660678646075, 34.69720439088952, 34.7176536366619, 34.74338667403964, 34.789988067727215, 34.80944939925078, 34.837240770547645, 34.86118021742242, 34.88678441977709, 35.00038356901129, 35.019534078742005, 35.04213289700265, 35.06478511837824, 35.083454274531945, 35.13768581730391, 35.15896174435664, 35.18471836350451, 35.214842784949376, 35.233619657215684, 35.32704166359806, 35.362335360255635, 35.383698483100346, 35.41009585292872, 35.42843879906769, 35.52399195193965, 35.57546182046602, 35.594377047686734, 35.61666040051681, 35.63445624099289, 35.67299614150604, 35.705246251885015, 35.723635242313165, 35.75690526606102, 35.774967240333226, 35.83878857720357, 35.90985386165878, 35.92726259729537, 35.95327227908061, 35.97198066892802, 36.02503103306101, 36.110980611661155, 36.127828575204724, 36.21673126666303, 36.25392074811276, 36.27394928049327, 36.30146365906616, 36.31844851878482, 36.40760288830232, 36.46126228389367, 36.47880840391483, 36.50271204173615, 36.51929371172508, 36.55529943020362, 36.58867540132175, 36.60533822351557, 36.63973619067977, 36.656230999596495, 36.7138217621747, 36.78754263717694, 36.803939604467566, 36.83060006525525, 36.84861446589871, 36.895585357530486, 36.98356934010043, 36.999692183732925, 37.08364259428911, 37.1232655423106, 37.14190201366128, 37.169873071620145, 37.18506474907595, 37.26843099266933])

#     y_data = np.array([0.5714883812053688, 0.7353110811754252, 0.8408176933847424, 0.8574381956032749, 0.8062800117811685, 0.8470013323937942, 0.8772651486763007, 0.9195402704773542, 0.8828705611839327, 0.921180964105438, 0.8744713796415042, 0.9307450678063265, 0.8963359726867982, 0.9164260846187525, 0.9456314946907302, 0.9274980384052189, 0.9179101199706454, 0.9506950733763346, 0.9324187253061473, 0.8742632998035217, 0.9646571537001821, 0.9472384272124218, 0.9222103799066993, 0.9065426929041197, 0.9479857505994328, 0.9280826108169505, 0.8953912464855422, 0.9357216450195, 0.9429762394223562, 0.972661017016406, 0.9712292905996694, 0.933189484917432, 0.9243768130511242, 0.9539226631759408, 0.9502682172027193, 0.9161275320065392, 0.9820142947577928, 0.9531781736459215, 0.9559220626479141, 0.9472052154883224, 0.9295725400378881, 0.9446465830993149, 0.9461115440152195, 0.9589282159060656, 0.9659303391471619, 0.9704672037021147, 0.9656241009450395, 0.9341930067703232, 0.917216241658134, 0.9743020951760958, 0.964877036467613, 0.9421029752853142, 0.9451796471114501, 0.9191261189606946, 0.9305817329359798, 0.9518558500449019, 0.9563888829128214, 0.9630337441777577, 0.976803473381766, 0.9634856103855608, 0.9578611888455675, 0.9286248931745544, 0.9403506619921081, 0.9503052581848322, 0.9462522162486073, 0.9346617985389298, 0.9593656562633985, 0.9694213746806714, 0.947654125420516, 0.9473120714365361, 0.9555536722143585, 0.9494874979460478, 0.9306930014402812, 0.9483442148945233, 0.9542682143172623, 0.9771018153827646, 0.9787629903219844, 0.94622071107976, 0.9723295426687278, 0.9515062022937982, 0.954157215292964, 0.9560347234997951, 0.9432693511021634, 0.9821905857973996, 0.954970063226551, 0.9452493778719355, 0.9571386489463746, 0.9633136485160305, 0.9717263886094354, 0.9540720618963638, 0.9470779840490813, 0.9622193919335852, 0.9586843264810614, 0.9699041784084834, 0.9855282965012389, 0.9575705105723794, 0.953709944920415, 0.9373982837060869, 0.9687932096675798, 0.9534480249283789, 0.9683224753975577, 0.978328518522063, 0.9623327400968126, 0.9545952184708861, 0.9303845328561272, 0.9660207043927719, 0.953390512644737, 0.9774233755251284, 0.9742847052290355, 0.977767224607695, 0.9660556569707662, 0.9678354255747246, 0.9631001537511762, 0.941000535579641, 0.9645470883592696, 0.947267445615344, 0.9745227427594597, 0.9639613535369361, 0.9616660989200324, 0.9496637033109111, 0.9580081463296749, 0.9908512460941579, 0.9498670767643457, 0.9698280888208469, 0.9483138506557771, 0.9697097882611478, 0.954383226618716, 0.9809066222296983, 0.9738664912031153, 0.9869974645367131, 0.974393984697372, 0.9650368717402121, 0.9441006369230219, 0.9490538882192893, 0.9722823897577605, 0.9543747564394154, 0.9617314311829186, 0.9557987665546542, 0.9510547447873505, 0.9575249537234403, 0.9517808621044327, 0.9350043206809678, 0.9667076951391832, 0.9798703549947438, 0.9668836783791829, 0.9739426378151004, 0.9667011355599864, 0.9578444713427732, 0.9700285021876021, 0.9767689937461118, 0.9645051196129425, 0.9796747890102967, 0.9729331403374927, 0.9718139588240059, 0.9714954531618705, 0.9665680893447408, 0.9715799804960468, 0.9434380694391281, 0.9600151224870214, 0.9680014501099987, 0.9626853501757008, 0.9589283821670713, 0.9475823775782832, 0.9645697134221269, 0.9615200311095805, 0.963437109181988, 0.9693295457597415, 0.9876209529008677, 0.9768890960158677, 0.9824790666843974, 0.9588528494401788, 0.9721063776781178, 0.9805193923038443, 0.962685267845407, 0.9431660312691424, 0.964868285924154, 0.956603925168463, 0.9675647984235609, 0.9717281895070099, 0.9826189439468521, 0.9726204354794205, 0.9604615887207204, 0.964630481693994, 0.9626400733003964, 0.9714004012804623, 0.9627909110720881, 0.9599493236708576, 0.9700721867479247, 0.9653063871055144, 0.9413698886258536, 0.9751684506322351, 0.9670020774599709, 0.9673744951312981, 0.9665846484246317, 0.9832840335616834, 0.9742359005404676, 0.9634186286259364, 0.9644124527877854, 0.9769349818646001, 0.9715108873770029, 0.9716748913041294, 0.9582955490072738, 0.9719374118836722, 0.9698464230502618, 0.9784737123875396, 0.9484383876030651, 0.9677554023096862, 0.963145784486494, 0.9853121053192578, 0.9678342046834766, 0.9773854367913998, 0.9626080980459776, 0.9540787002192684, 0.9662825894805267, 0.9661819432904153, 0.9653297976328042, 0.9902736552767051, 1.0132484443601424, 0.9791959067600647, 0.9459619429068575, 0.9759515495638341, 0.9871119366205464, 0.9694209017951081, 0.9602408449051252, 0.9628381835732438, 0.9733452358629568, 0.9752700754000907, 0.9830280874942972, 0.9661590690870184, 0.9654019762091868, 0.9659784925760989, 0.9803012740594019, 0.9664335178383717, 1.0007488427550368, 0.95974670132827, 1.0014091260579412, 0.9696182598586509, 0.956300993224844, 0.9576475631659507, 0.9506629277120915, 0.9671998197844939, 0.9641182138557043, 0.9665441556405766, 0.982430117805305, 0.9869786464450984, 0.9641133877009538, 0.9647915102843662, 0.9844304861118656, 0.9842497507058282, 0.9704738296507288, 0.9771968665378865, 0.9792276868004681, 0.9743365913000973, 0.9834353942110573, 0.9625254840685575, 0.9679327625062782, 0.9530948653125381, 0.9735411182606956, 0.9528626918212109, 0.9714230114402231, 0.9740895271327515, 0.9710965439492728, 0.979014431968354, 0.9587831273207938, 0.9868043198054098, 0.9585042703627377, 0.9643444324183524, 0.9573401575098818, 0.9862272266415651, 0.9716480390305907, 0.9686268655529389, 0.9768200075669342, 0.9643708657679296, 0.9676860171500655, 0.9699788812251166, 0.9800792109563748, 0.9841779689485022, 0.991192360118255, 0.9820933858447859, 0.9844627131727196, 0.9762702936541953, 0.971968201547442, 0.9623119243199524, 0.9641536146887395, 0.9719260918284109, 0.9662763280332665, 0.9800435678616491, 0.9726496742718682, 0.976623000408359, 0.9787644793555998, 0.9718411459732651, 0.9668569927243676, 0.9726787167897827, 0.9663009178282306, 0.9754776277307435, 0.9596341960443746, 0.9762527229438948, 0.9790906952551596, 0.9872862524545186, 0.9776495360483488, 0.9857333448777537, 0.9589683812214008, 0.9673903591106522, 0.9828989888266928, 0.962081512429101, 0.9828243490273519, 0.9781345319752565, 0.9621789262263745, 0.9762153847579249, 0.9827136529368208, 0.9808834424605445, 0.9393949370029149, 0.979694901527815, 0.9886655955540877, 0.961219367996941, 0.968137572111774, 0.9829217814736668, 0.9694801998289748, 0.9687192180951297, 0.9862658228761686, 0.9659258342776829, 0.964796048137749, 0.970432265690066, 0.9873761698995002, 0.9822639519444898, 0.9858514767092401, 0.9701359349417311, 0.9639947268319383, 0.9755352842636986, 0.975335680055424, 0.9649139079717978, 0.957862167274383, 0.9730369915626469, 0.9678773655738705, 0.9719544951488924, 0.9825266961549, 0.9905820512601008, 0.9909862325599742, 0.9855786145746616, 0.97643575609608, 0.9761119696318546, 0.9756095747468639, 0.973956356611179, 0.9777411448490108, 0.9735687361730591, 0.9865937757277737, 0.9813806880525864, 0.9844465726067937, 0.9882587979777913, 0.9660332899242546, 0.9699236516193737, 0.9766018089735065, 0.960402574730398, 0.973817440724194, 0.9620612211019234, 0.9747920810637372, 0.9781320088453691, 0.9717983741648113, 0.971097198722804, 0.9645645569028584, 0.9550082479066837, 0.9684146166835275, 0.981847240155485, 0.9666477242913524, 0.9858630949741679, 0.9879836411323758, 0.9874507003087264, 0.9686280268098799, 0.9741883792872872, 0.9718742094413036, 0.9784153590173578, 0.982585238102184, 0.9938586750600109, 0.9840115431542104, 0.9791002291290094, 0.972583530200794, 0.9707130784069878, 0.9996738408027224, 0.9594311074282345, 0.9669020712076691, 0.982254017028771, 0.9700053114737649, 0.9596606434466214, 0.9599879265621205, 0.9786127295040831, 0.9924711313701045, 0.9834054145965934, 0.9724442055832927, 0.985357573635743, 0.981585303152193, 0.9675169199230298, 0.9703692601495191, 0.9834740162366592, 0.9929637228294496, 0.9798701526819191, 0.9675737369759527, 0.9836251054225484, 0.9746142190877118, 0.9782645462269302, 0.9716296463583005]
# )

    # y_data=np.array([0.5261822785960747, 0.7016261324338564, 0.8311153702973231, 0.8096956591597884, 0.8495642282090791, 0.8654692313121052, 0.839199498163616, 0.9085362149542839, 0.8513470432732447, 0.9001726249058271, 0.8950124204779816, 0.907668980071644, 0.9031218118106544, 0.9214391837961681, 0.8893811762865164, 0.9059586718183564, 0.9109210797802736, 0.9294387498048619, 0.9188112912707247, 0.8927896668281828, 0.9248774340193954, 0.9338215364794936, 0.9068909227744741, 0.9246239022887203, 0.9520270058884596, 0.9498761809814903, 0.9196019816168937, 0.9437340228536715, 0.944313268079427, 0.9278379876996274, 0.9261103388501322, 0.9500006535705887, 0.9466125241110879, 0.9370234790709594, 0.9340953570925369, 0.9221896255190635, 0.9259601882563859, 0.9271328179094825, 0.9294833643779605, 0.9461588811982325, 0.9273312025652177, 0.9414926483076208, 0.9522081637338917, 0.9236849018003512, 0.9308420442542763, 0.9249921454312156, 0.9329751379818384, 0.9479449674428243, 0.9540751393673358, 0.9397527576533303, 0.965211056027639, 0.9492701083053754, 0.9313960433738502, 0.9679288728062372, 0.9506326962295482, 0.9465215840773747, 0.9476461306065661, 0.9432300296783052, 0.9293935931777318, 0.9509416610476826, 0.9600074664704168, 0.964989051187453, 0.9671273778532503, 0.9638132209007647, 0.9553783353848156, 0.9420183496650745, 0.9450115446173203, 0.9226703897839831, 0.9473914224142186, 0.9522412170744886, 0.9688626045105181, 0.9354954513000082, 0.9472195198054604, 0.9280795755338994, 0.9259144304940888, 0.948158615334545, 0.9457724737567496, 0.9481748026456764, 0.9380775474723606, 0.9668286765258485, 0.9511876169233262, 0.9349389988788013, 0.9669559751252902, 0.9689714697091361, 0.9360736680721535, 0.9571959597809326, 0.9326275480979962, 0.9551035046797858, 0.9432717663030068, 0.9518739191746899, 0.9631047681711613, 0.9556659331245954, 0.9600860184950997, 0.9540317966766745, 0.9653358207249874, 0.9681215109127482, 0.9589654451789035, 0.9690066286810748, 0.9543109173204875, 0.9524160004706368, 0.94724269548714, 0.9399364496842162, 0.9612852151618485, 0.9681975931661936, 0.938390901608463, 0.965331750949727, 0.9525594410516562, 0.9583786505343964, 0.9492373662049798, 0.9436586864205, 0.9727147873174554, 0.9448900604443753, 0.9637569990760646, 0.9654126497789326, 0.9541167902036085, 0.9461911945911045, 0.9427934130325681, 0.9470195585368119, 0.9742042022830311, 0.9714970799388121, 0.955534115265416, 0.9723529695489447, 0.9688630802405838, 0.9633383461862189, 0.9582062294706675, 0.9492498061227116, 0.9608186428571508, 0.9560331132306281, 0.9362940651136843, 0.966364197948251, 0.9652926400698283, 0.9651821428872804, 0.9430868744438398, 0.9430053574410584, 0.9680570039376879, 0.970649208309371, 0.9622337826976439, 0.9586510787507032, 0.958974084233483, 0.9815283886232719, 0.9719308769786575, 0.960642509875298, 0.9559247709146205, 0.9729019822748758, 0.9496060010141629, 0.9552922283275717, 0.9750165298999788, 0.958587259093155, 0.960562568029829, 0.9810851262221124, 0.9425385798824231, 0.9527501723033132, 0.9557929661731686, 0.9674719977554908, 0.9619545667252306, 0.9575590603939463, 0.9650868127290014, 0.9746842848130894, 0.9724159503535336, 0.9465018217996899, 0.9628914233820198, 0.9770530797652632, 0.9642316099166146, 0.9561465762688947, 0.9699668476785548, 0.9501268038858676, 0.9477818875197418, 0.9637902912341277, 0.9659918054328216, 0.963569609738076, 0.9541620120723903, 0.9580195829390626, 0.9647531960416681, 0.9786148341070974, 0.9605232275908142, 0.9614457725484065, 0.9743986101444777, 0.942619328318199, 0.9667093594239323, 0.99233740763852, 0.9628601418244451, 0.9597711756372251, 0.952334694670221, 0.9852532073642715, 0.9614279945231853, 0.9799879511085963, 0.9671966885167299, 0.9440149598639297, 0.9491357277585633, 0.9697004453549631, 0.9695057120482197, 0.9522135522942815, 0.9537322644453984, 0.9603542338192298, 0.940497999355657, 0.975291807492543, 0.9555525097487247, 0.9868788654060932, 0.9603045954094683, 0.9561177814164777, 0.9671423063095387, 0.9643235694741168, 0.9914315104976988, 0.9698728991701826, 0.9724540829795683, 0.9585167508805376, 0.9785406699259533, 0.9803792134337408, 0.952995166641239, 0.963781021456527, 0.9496180294285003, 0.9571990563241378, 0.9578327851182934, 0.952006122236246, 0.9563488117209538, 0.9597134687204022, 0.962812379139586, 0.9661742519026353, 0.9843129181861845, 0.9509467850388507, 0.9730236628492261, 0.953625005205581, 0.9423805445577251, 0.9812230938094559, 0.9716337890816189, 0.9564884321980935, 0.9712674616959608, 0.9701762025061045, 0.9713726667678606, 0.9683057413630104, 0.9730762240577235, 0.9574174472576835, 0.9632156435156447, 0.971518012653466, 0.9615396088453785, 0.9770077331880703, 0.9558169802340359, 0.9701439225312238, 0.9633773855340937, 0.9609101960955936, 0.9696455990215265, 0.9728449001442268, 0.9540928294568103, 0.9590639788172841, 0.9606642339838103, 0.9780500461460758, 0.9875350123916731, 0.958711721823815, 0.969842369502044, 0.9678313427065913, 0.9524970989492033, 0.9575167577459376, 0.9683874983159738, 0.9573880941950415, 0.9580336184201989, 0.9605510459741977, 0.9814045367741993, 0.9492273415657005, 0.9609007938275621, 0.9686416965067766, 0.9691071564504702, 0.9740735986348835, 0.9497410772431303, 0.9592497984332782, 0.9720734489323177, 0.9829853791654655, 0.9545890193739526, 0.9796000793985001, 0.9760775928237021, 0.992899182635112, 0.9619688963069524, 0.9703541500547556, 0.9683044758884773, 0.9731411173128258, 0.9784707646173387, 0.9645619955081322, 0.9684659447101391, 0.9635845054920119, 0.9622843401704533, 0.9755633191102459, 0.9619577230896184, 0.9571448236482728, 0.9624355248654897, 0.969251518854318, 0.9686919383542704, 0.9638547370731875, 0.9539563376751526, 0.9841386073705618, 0.9801970383735908, 0.9743585845109847, 0.9643519156223751, 0.9750032238941857, 0.9690740750264746, 0.9581064763256265, 0.9782220306665897, 0.9659214632277043, 0.9829945516229951, 0.9886371512204729, 0.9702035658044998, 0.9675005875629694, 0.9618086824291419, 0.9719546437351226, 0.9697026420457998, 0.9791189010407667, 0.9597464195573676, 0.9627033246900956, 0.9799919529910084, 0.9562473926088473, 0.9578630512738185, 0.9610179703630192, 0.9646680834342284, 0.9648892403796769, 0.9640796996629765, 0.9664719086110916, 0.9725193651314733, 0.9640891799938852, 0.9846367789999724, 0.9803762173798564, 0.9692977562363012, 0.9647337749583723, 0.9656088880513163, 0.9611174579805543, 0.961911614051642, 0.9602542647188669, 0.9683898910626506, 0.9652785913615198, 0.9460121805320657, 0.965285907594431, 0.9735313582740386, 0.9629274734272719, 0.9751644375603459, 0.9760016979592586, 0.977412315839316, 0.9720398993684547, 0.9848970813564283, 0.964624213628443, 0.9737044263171742, 0.9762064999021437, 0.9845346308602643, 0.9823593244465881, 0.9609876731794027, 0.960152417669222, 0.972560248875233, 0.9709344430814373, 0.9816920233064681, 0.980427289096101, 0.9792513130320637, 0.9543840782436739, 0.9783445006150961, 0.9676490731263495])

    #y_data*=0.966
    #y_data*=0.9933195162111834


    # Final2:
    x_data=np.array([2.001838006660277, 4.957844177107756, 8.252172230287432, 8.397577117218463, 9.895652087539101, 10.199107309538137, 10.67146815764522, 11.534895586205192, 11.63585097605136, 12.625268794245018, 12.99399981870877, 13.261219659116186, 14.070860726808483, 14.148639753793514, 14.285506005384557, 14.391098305027176, 14.524742394618798, 15.245625648442466, 15.319897446873815, 15.798659958378396, 16.241233140810884, 16.3088251996885, 16.45289889999463, 16.51940760507045, 16.834522486398484, 17.271355292037146, 17.331506261294646, 17.55415979837315, 17.64577423719572, 17.805691840867233, 18.120709364245766, 18.181175447181577, 18.288947745736824, 18.36631830816686, 18.515291694661983, 19.045260736765023, 19.09935859672302, 19.260674231560003, 19.38559845852348, 19.453256448274605, 19.821571320355122, 19.874240298889475, 19.95995691756904, 20.046694267544527, 20.096042154587217, 20.313675235911646, 20.37804212384858, 20.503891034282542, 20.6895426810593, 20.739797200359543, 20.924025259513833, 21.005990756077896, 21.127054172200054, 21.40584948633385, 21.453515105599216, 21.54536820297031, 21.611735020305968, 21.677220351497937, 21.874535055480056, 21.921046468184358, 22.078424933781083, 22.213344739655312, 22.258962382830855, 22.461543051178047, 22.505513853146812, 22.623255683164512, 22.76206592168566, 22.805001851064688, 22.85562936997269, 22.89897269686584, 22.96120969930122, 23.04619235700286, 23.08816208048849, 23.255194959428717, 23.336484676663964, 23.41609142766362, 23.612230966315096, 23.652918956761308, 23.79145594387666, 23.885025488462233, 23.93799269142562, 24.128998693598067, 24.16879467348292, 24.212145914846733, 24.25669436876215, 24.295579629356006, 24.392823198615485, 24.434984676286376, 24.53678192126808, 24.66886172879788, 24.708281443722758, 24.887959205626316, 24.952094477475477, 24.990000814627855, 25.145658536378022, 25.208827579954978, 25.28763008171394, 25.440825658345105, 25.477818355563777, 25.522224390399447, 25.561309575390652, 25.606493334813482, 25.695588691579765, 25.73190525417028, 25.8549705610647, 25.954737720285326, 25.99388674479525, 26.187213025442425, 26.22265355146607, 26.256916950063204, 26.42873123828126, 26.466458012311367, 26.564952677811508, 26.68751697605551, 26.72150248259217, 26.76580958039528, 26.80151534738131, 26.8532043294116, 26.929475015925963, 26.962700044563135, 27.085308089111212, 27.174353376937365, 27.21521120502592, 27.39447334990587, 27.427251952101823, 27.459220871149245, 27.627670303073497, 27.66018212473118, 27.756915524895458, 27.87112387893874, 27.90308286097929, 27.946758823921904, 27.979852890273893, 28.01083993336696, 28.042171211685258, 28.073480621901254, 28.10554101814241, 28.137078891886095, 28.27211362961194, 28.33908263716144, 28.396405415006974, 28.551656236601605, 28.5822125827696, 28.628593612517335, 28.775364114598524, 28.805556462234055, 28.844808630199935, 28.99460896884544, 29.02450244529228, 29.05428353469015, 29.084064797526647, 29.112887767888697, 29.144692537359596, 29.173531363703056, 29.203057413816975, 29.234745035480827, 29.26391905462923, 29.411210795609506, 29.457183570910026, 29.531923917519443, 29.664221235289357, 29.692049328189963, 29.73776148949696, 29.81857192040467, 29.846360207681997, 29.876604298756696, 29.90547007849565, 29.950185375341498, 30.088555455231475, 30.115499846832627, 30.143150836932726, 30.17120577859588, 30.198984276656326, 30.229760807906235, 30.256712350354274, 30.286979343239324, 30.31880981812001, 30.34520689738067, 30.489429272129815, 30.529952586017647, 30.556649186190484, 30.60112858496851, 30.726414551508206, 30.752115036690938, 30.784024565083854, 30.874808673638462, 30.901054577800714, 30.93025015001706, 30.958993541003665, 30.984497938116142, 31.130468688738652, 31.161171713426288, 31.187921821535387, 31.215980951012856, 31.241509425407276, 31.27113599555539, 31.29727487032142, 31.32454615751083, 31.356414973405926, 31.38175701450161, 31.474811503769196, 31.526400018061217, 31.55087125413878, 31.576538822509676, 31.60143573385597, 31.695675844384446, 31.76663169262822, 31.79081764632448, 31.852402950032733, 31.91084898296158, 31.93513950410669, 31.966629786184864, 31.99088697184736, 32.06466779938039, 32.162519032690454, 32.1860481394285, 32.20968232589884, 32.23379280973134, 32.25733308068112, 32.28708488706849, 32.31008269454021, 32.33834034435376, 32.36851721811909, 32.391949445680545, 32.49800782026829, 32.5319346852723, 32.556165739989375, 32.58230165391237, 32.60520621022349, 32.716010905518054, 32.76598800832813, 32.78835235191602, 32.85869513617138, 32.90469294964028, 32.92883122724532, 32.960712570621, 32.9829695587737, 33.060313893352166, 33.12772749433645, 33.14953404936685, 33.175490179716796, 33.197442102920924, 33.218602075509466, 33.24189712237767, 33.270721577096666, 33.292436858707454, 33.32296166014465, 33.34964395948286, 33.378915086185295, 33.48613282331618, 33.50770531781199, 33.53232563153902, 33.55717169374482, 33.57843443011584, 33.70884649495667, 33.73482635901533, 33.75586426572382, 33.776677352300666, 33.79783090629984, 33.84918301979536, 33.87178727160055, 33.89710217361228, 33.92518451150978, 33.94641413045142, 34.049458091530944, 34.08817635545785, 34.10943657470806, 34.13304793123942, 34.15376297563311, 34.17426262068559, 34.19868354956541, 34.22482964025969, 34.245291194765656, 34.27916345719189, 34.30174906851934, 34.349700712966175, 34.43440161354845, 34.45435471647417, 34.48097861225719, 34.503588205992514, 34.543381387804494, 34.65369356775843, 34.67341603503508, 34.69443181437459, 34.71502459811464, 34.73679321777004, 34.78741035325362, 34.80630382380363, 34.833032998107214, 34.85911579967335, 34.87841716460867, 34.99126652895544, 35.01639066471044, 35.038132145032485, 35.06158885530706, 35.08041819189665, 35.099541628200676, 35.12543704715567, 35.1504077639657, 35.1693694869046, 35.204844674527685, 35.22430343099853, 35.24301701723557, 35.26427585927356, 35.3475312523161, 35.36642208438843, 35.3902793881811, 35.41437186241269, 35.43280309030579, 35.55270491918632, 35.57962999003638, 35.59919210796322, 35.619730626755, 35.63737751952461, 35.683487264275165, 35.70786569618354, 35.73002026049893, 35.76089211969556, 35.77877760255285, 35.864093737480694, 35.913017430194984, 35.93163177142023, 35.95776526151879, 35.97325968060115, 35.98239788695661, 35.991810568786235, 36.007587635826795, 36.03938567549039, 36.05655810401052, 36.08314237658071, 36.111388428579716, 36.12386979664184, 36.13247386552115, 36.143772060675786, 36.18278286957453, 36.245943067479296, 36.2625164027008, 36.29054207356309, 36.311054831124494, 36.349440895329025, 36.45361814235051, 36.47000061156269, 36.49129574402426, 36.51058485973488, 36.5300273716175, 36.57969872010579, 36.596382792275875, 36.623196980421326, 36.64887316993782, 36.664878829398134, 36.775617339916664, 36.795917456766595, 36.81697123865105, 36.840270303757734, 36.853314685561315, 36.861308569979336, 36.871534536713696, 36.89204119264455, 36.92047819914167, 36.93633300452944, 36.96717837272806, 36.98877978317173, 36.9994604336634, 37.00753025815847, 37.02050273030094, 37.077352112128075, 37.120291754220446, 37.13665261275266, 37.16761631994717, 37.182993374101635, 37.250984991341085, 37.3232571787428, 37.33880072925153, 37.362527661115585, 37.378306717469556, 37.40716516315713, 37.44686950047088, 37.46202313561004, 37.493741439221246, 37.512624121092394, 37.55139672548562, 37.641560213901286, 37.65654971876773, 37.68118679797924, 37.70013693884144, 37.710511114549995, 37.718036384265694, 37.730157004494735, 37.75564554790652, 37.778528431402044, 37.792596860936236, 37.830555731603255, 37.844716008621425, 37.8535010246662, 37.86183751515782, 37.87537694726199, 37.951171040732355, 37.97379039463953, 37.99338263263764, 38.01986138457219, 38.03400283354424, 38.1317355266828, 38.17195895777572, 38.187873306086495, 38.210671591380375, 38.22426389160011, 38.264046897903974, 38.29223874951938, 38.307306250466674, 38.34235132625888, 38.35601470306164, 38.421563182233555, 38.48289301255224, 38.49609019485814, 38.52487513424924, 38.53863009599693, 38.54748206897604, 38.555221236639525, 38.56768423611194, 38.59847968490326, 38.61491910291245, 38.635176775908675, 38.66717982524519, 38.679524326964405, 38.68709664110768, 38.69638333831699, 38.720257926740686, 38.79270556231621, 38.805034117161846, 38.83048624977936, 38.85188765329968, 38.86895640663388, 38.987344824021726, 38.999102742961945, 39.01826641129436, 39.038062613667606, 39.05020743713786, 39.101010010172274, 39.11623639723752, 39.13827195959626]    )
    y_data=np.array([0.5039230193348108, 0.6617698328317563, 0.8363978099978737, 0.8251947090630536, 0.8507112084360098, 0.8573608764015135, 0.8548949487640481, 0.8745816333221477, 0.8493225310195378, 0.9241758645671869, 0.874517413735633, 0.9020569751809566, 0.900307735717281, 0.9187738701297004, 0.8934690063730726, 0.9222893347563851, 0.9208633251892739, 0.9324079750264677, 0.9079827727110105, 0.9139062543055436, 0.9380327421013649, 0.9243306004560133, 0.9139922471960144, 0.9400823653763111, 0.9447297119812808, 0.942146727440269, 0.9607152965648409, 0.9699845130349308, 0.945637046071138, 0.9252392832009376, 0.9222110158009665, 0.944853226003186, 0.9357620174938917, 0.9484198226421205, 0.9624089431979296, 0.9430535363515046, 0.934388337793099, 0.9372490951226149, 0.9398759223535776, 0.9479533194162738, 0.9177144329117803, 0.936939566064905, 0.9404384496314911, 0.9231024202592153, 0.9377124293685146, 0.9373298007482406, 0.9606261413057325, 0.9578315275957883, 0.9641521701808279, 0.9499839504265276, 0.9761952817399098, 0.9580837812931564, 0.9311793132291737, 0.9633670857255623, 0.9371114071467572, 0.9502429016347298, 0.9520927061979984, 0.9386864561667171, 0.932005086619607, 0.9638035527021757, 0.9690452314874947, 0.9482440062188191, 0.9532350156417836, 0.9569753357692994, 0.9547988282837464, 0.9569410942948573, 0.9654436679165616, 0.9334001623790402, 0.9501487183449789, 0.9714985579696689, 0.9687072973794809, 0.9366989599620293, 0.9473710365307533, 0.9437109886942592, 0.9316185920248446, 0.957427609054948, 0.9411742212358013, 0.9450256885980363, 0.9557251585290988, 0.9637986090916965, 0.9518498826206669, 0.9467872203184173, 0.9691391188137979, 0.9592369930545662, 0.9483617371513452, 0.9526724670675496, 0.9522752846690615, 0.9530861975660033, 0.9576174697533832, 0.947544677260766, 0.9573468799904661, 0.9746984217791328, 0.9803923712389069, 0.9628040207041155, 0.9793510842279752, 0.9614879661795563, 0.9730348281725015, 0.9715524431565313, 0.9612061795791967, 0.9548779458924699, 0.9431760014922592, 0.943227408670473, 0.9716138622398424, 0.9693725629468517, 0.9457866960472191, 0.9682345208676686, 0.9430239197675115, 0.9701674920563492, 0.9611597689677813, 0.9590459059386379, 0.9590027624134008, 0.947017297417525, 0.9658013153555645, 0.9798903807676135, 0.9578143229528344, 0.9405616743178485, 0.9408495829676741, 0.9466987503988862, 0.9699194501347289, 0.9568025357587557, 0.9395277632792685, 0.9588988589866312, 0.9783497161176592, 0.9715523870025672, 0.9647876068403842, 0.951896453164054, 0.9685815573496757, 0.9634537543383824, 0.9459411563369905, 0.965551578929067, 0.9649090486704359, 0.9525272227490207, 0.9482465302575886, 0.9520869241536729, 0.959599855803199, 0.981839965615813, 0.9751577809448091, 0.9468288463566154, 0.9875593453151508, 0.9829289425292944, 0.9804405070273462, 0.9756071049984735, 0.9653923554952659, 0.9760852007987013, 0.955329620071379, 0.9696731277069162, 0.9675233048503243, 0.961161450516212, 0.9626696899371646, 0.9702260530811714, 0.9720652102612177, 0.9373480386515591, 0.9673931122192221, 0.9715805991332804, 0.9688318266956366, 0.9510998348673019, 0.9623473505019501, 0.9746786373718802, 0.9761428806632199, 0.9576199209005897, 0.9655638892840425, 0.9645721038863481, 0.9592661690373415, 0.9607597726426366, 0.9722985709918797, 0.9453459463739143, 0.9654651792761824, 0.9667815083165049, 0.9693113730104641, 0.9578381671851618, 0.9558370267797726, 0.9577975241457216, 0.9781547867510403, 0.9625111430411353, 0.9702620070690222, 0.9559145119473856, 0.9774254837107733, 0.9625261393464727, 0.9617469830986234, 0.9727295883510956, 0.973955514855257, 0.9528870294664504, 0.9485428766850876, 0.9674795874844645, 0.9773074363908834, 0.9638949172354394, 0.983035737134582, 0.9723959467699989, 0.9477210667206212, 0.96842158419385, 0.9809300381889716, 0.9673420123272591, 0.9474293814277099, 0.9567248192675025, 0.9515689563042864, 0.957224005958658, 0.9647489111123895, 0.9944336847000055, 0.9922766848827963, 0.9630808108206048, 0.9673871172841177, 0.9651719427361125, 0.9723917313842857, 0.9833556589567374, 0.9686151500828885, 0.9645139480759636, 0.9557929116065648, 0.9889605276155691, 0.9658732553526531, 0.9641338770980339, 0.9584449149739769, 0.9724696370698406, 0.953300272217819, 0.9604486343469677, 0.9603522567075771, 0.9684893857971023, 0.9454575755158297, 0.9581854801054266, 0.9866634631065884, 0.9857678396388786, 0.9663431563512127, 0.9734150799143834, 0.9795512846993639, 0.96053725926321, 0.9782986166120979, 0.9688447722335306, 0.9757208001931004, 0.968721693728171, 0.9661135336308788, 0.9623812426538079, 0.967410117952469, 0.9765187851966295, 0.9575329295114993, 0.9712332546997184, 0.9677370519167554, 0.9665404497600822, 0.9826819996799, 0.9609646250432796, 0.9729986576261741, 0.9857310011005112, 0.9906848645167186, 0.9854244875038348, 0.9830312300368673, 0.9753210119960556, 0.9713359389711789, 0.9660661402846331, 0.9647536128627593, 0.9784612382137756, 0.9881299966935587, 0.952413291330611, 0.9587499030347574, 0.9765982377153776, 0.958003655612739, 0.9698593129817045, 0.9612454535047766, 0.9573613269538019, 0.9625570095717976, 0.9672251241897307, 0.9690216356995784, 0.957941950248078, 0.959409550793558, 0.9686811844748603, 0.9664737169167286, 0.9604792809306619, 0.9691921418013595, 0.9537708018894496, 0.9743164398821503, 0.9769341512573824, 0.9769081599382649, 0.966362810567563, 0.9848085104613782, 0.9714865058668474, 0.97929534307081, 0.964972763171477, 0.9594671868551125, 0.9741605654144457, 0.963054198947301, 0.9802006304124565, 0.9676390985984566, 0.9625435087074472, 0.9640303525808814, 0.9681768105014271, 0.9839271078322791, 0.969795507929424, 0.9602885829006519, 0.9598832757819266, 0.9890173215087356, 0.9841240678321677, 0.9766879660012973, 0.9757058000942593, 0.9893324207856463, 0.9744994861027462, 0.982650428333239, 0.9673472037552215, 0.9623499900081921, 0.9743059955389376, 0.9736423309738362, 0.9652717527337168, 0.9696042441550178, 0.9729203277480325, 0.9659621801237721, 0.979069013016642, 0.9745541388692212, 0.9567546615509758, 0.9739078609488143, 0.9598624459687308, 0.9698118058301559, 0.9667909765167706, 0.9712467349819185, 0.9788921046394577, 0.9827699981455364, 0.9812133938692527, 0.9739886459264061, 0.9727131830697983, 0.9558713529602904, 0.9619772942811743, 0.9825080694437124, 0.9763763347441632, 0.9733261833133718, 0.9548644164958588, 0.9735802050967588, 0.9645856834446392, 0.9843609860703721, 0.9677111262861312, 0.9699297382370107, 0.9785595918433013, 0.97519753188992, 0.9551266777197207, 0.9784739888677874, 0.9584637370430105, 0.9582283731446014, 0.962264768199984, 0.9663445271837589, 0.9723534668277878, 0.969191017040025, 0.9801496496133006, 0.972318350470877, 0.971025133883191, 0.9780672394851416, 0.9564033506794773, 0.9738042583827149, 0.95726688988262, 0.9857438998691395, 0.9785888464896721, 0.9681802771891083, 0.9650998129380713, 0.978145059731363, 0.9770743541659858, 0.9701445045401522, 0.9610418580471891, 0.9737780292780235, 0.9780556938762369, 0.9725597804081617, 0.9701239311739603, 0.9619719597442766, 0.9551029790517401, 0.9669360909742671, 0.9779002363191812, 0.9842724231743825, 0.9928714882406144, 0.9698121682782117, 0.9779789291640634, 0.9726801889088379, 0.9924878953351208, 0.9714304366726533, 0.9712146992973983, 0.9825059650982554, 0.9876718157289628, 0.9529121952760403, 0.9735345151321281, 0.9606976807732681, 0.9799139332932989, 0.9610143508863724, 0.9574675543231441, 0.9573377991871959, 0.9754069988389026, 0.9799036744829935, 0.981256852425782, 0.9759786780176486, 0.9730167941022575, 0.9775057443759905, 0.9821745295299067, 0.9792939150828275, 0.9526017388778272, 0.970289461121747, 0.9736694441707526, 0.9804598200782348, 0.9882301339144216, 0.9710982753396982, 0.9601065673372537, 0.9616243171925994, 0.9823574897593573, 0.9819312979886102, 0.9818172886031447, 0.9679017907361195, 0.9812554044101488, 0.9711175667706128, 0.966202718989108, 0.9567270175819164, 0.982882470472214, 0.9691178406821878, 0.9832382109389798, 0.9708135067504727, 0.9612841963342769, 0.9770075389874829, 0.9837532668115918, 0.9825444184632823, 0.9564317908138689, 0.9608015092843716, 0.9664036677703695, 0.972801930188518, 0.9718832734647903, 0.9743642368437484, 0.9572548013197825, 0.9853593042524901, 0.9690594349420227, 0.9800046777840754, 0.9738500925573359, 0.9772202285300309, 0.9720034203505533, 0.9904380281578017, 0.9728449605279718, 0.9862349244001021, 0.9845254884157562, 0.9821083163338191, 0.9542328935000601, 0.9703326284751789, 0.9662445104438564, 0.9686859757017976, 0.9832835955074265, 0.9813765720524453, 0.977167348132205, 0.958962860282452, 0.9554778610053534, 0.980966005085363, 0.9804501660350827, 0.9783335124272667, 0.9658875216668289, 0.9748635992471377, 0.9847426529881187])
    #y_data*=0.936831250

    #print(y_data[0])

    # ---------------------------------------------------------
    # 2. Define the comparison curve f(x) = x / (1 + x)
    # ---------------------------------------------------------
    x_curve = np.linspace(0, 40, 400)
    y_curve = x_curve / (1 + x_curve)

    # ---------------------------------------------------------
    # 3. Plot
    # ---------------------------------------------------------
    fig, ax = plt.subplots(figsize=(7.2, 4.8))

    # curve
    ax.plot(
        x_curve,
        y_curve,
        color="black",
        lw=2.0,
        ls="--",
        label=r"Theory: $x/(1+x)$",
        zorder=1,
    )

    # data
    ax.scatter(
        x_data,
        y_data,
        s=42,
        marker="o",
        facecolor="#2C7FB8",
        edgecolor="white",
        linewidth=0.6,
        label="Computed values",
        zorder=2,
    )

    ax.set_xlim(0, 40)
    ax.set_ylim(0.0, 1.05)

    ax.set_xlabel("Number of open modes (from energy)")
    ax.set_ylabel(r"$\langle w_{12}\rangle$")
    ax.set_title("Computed values vs. theoretical curve", pad=10)

    ax.grid(True, which="major", alpha=0.22, linewidth=0.8)
    ax.minorticks_on()
    ax.grid(True, which="minor", alpha=0.10, linewidth=0.6)

    ax.spines["top"].set_visible(False)
    ax.spines["right"].set_visible(False)

    leg = ax.legend(loc="lower right", frameon=True)
    leg.get_frame().set_edgecolor("#dddddd")
    leg.get_frame().set_linewidth(0.8)

    fig.tight_layout()
    if SAVE_PNG:
        fig.savefig(OUT_PNG)
        print(f"[ok] wrote {OUT_PNG}")
    if SAVE_PDF:
        fig.savefig(OUT_PDF)
        print(f"[ok] wrote {OUT_PDF}")
    if SHOW:
        plt.show()
    plt.close(fig)

if __name__ == "__main__":
    main()
